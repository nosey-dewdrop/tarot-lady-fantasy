<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mystical Tarot Reader</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Georgia', 'Times New Roman', serif;
    background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
    color: #fff;
    min-height: 100vh;
    overflow-x: hidden;
    transition: all 0.8s ease;
    font-style: italic;
}

/* Love Theme */
body.love-theme {
    background: linear-gradient(135deg, #ff6b9d, #e91e63, #9c27b0, #673ab7);
    color: #fff;
}

body.love-theme .frame-section {
    background: rgba(255, 105, 180, 0.15);
    border: 1px solid rgba(255, 192, 203, 0.3);
}

body.love-theme .action-btn {
    background: rgba(255, 182, 193, 0.15);
    color: #f8a5c2;
    border: 1px solid rgba(255, 182, 193, 0.3);
}

body.love-theme .action-btn:hover {
    background: rgba(255, 182, 193, 0.25);
    border-color: rgba(255, 182, 193, 0.5);
}

body.love-theme .wide-arc-card {
    border-color: #ff69b4;
    color: #ff69b4;
}

body.love-theme .star {
    background: #ffb3d9;
}

/* Love Theme Interpretation */
body.love-theme .interpretation-content h4 {
    background: linear-gradient(135deg, #ff6b9d 0%, #e91e63 50%, #9c27b0 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

body.love-theme .interpretation-card::before {
    background: linear-gradient(135deg, #ff6b9d 0%, #e91e63 100%);
}

body.love-theme .interpretation-card h5 {
    color: #ff69b4;
}

/* Career Theme */
body.career-theme {
    background: linear-gradient(135deg, #2c3e50, #34495e, #5d4e75, #85144b);
    color: #fff;
}

body.career-theme .frame-section {
    background: rgba(255, 215, 0, 0.1);
    border: 1px solid rgba(255, 215, 0, 0.3);
}

body.career-theme .action-btn {
    background: rgba(255, 215, 0, 0.15);
    color: #ffd700;
    border: 1px solid rgba(255, 215, 0, 0.3);
}

body.career-theme .action-btn:hover {
    background: rgba(255, 215, 0, 0.25);
    border-color: rgba(255, 215, 0, 0.5);
}

body.career-theme .wide-arc-card {
    border-color: #ffd700;
    color: #ffd700;
}

body.career-theme .star {
    background: #ffd700;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
}

/* Career Theme Interpretation */
body.career-theme .interpretation-content h4 {
    background: linear-gradient(135deg, #ffd700 0%, #ff8c00 50%, #ff6347 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

body.career-theme .interpretation-card::before {
    background: linear-gradient(135deg, #ffd700 0%, #ff8c00 100%);
}

body.career-theme .interpretation-card h5 {
    color: #ffd700;
}

.stars {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
}

.star {
    position: absolute;
    background: #fff;
    border-radius: 50%;
    animation: twinkle 3s infinite;
}

@keyframes twinkle {
    0%, 100% { opacity: 0.3; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.2); }
}

@keyframes float {
    0%, 100% { transform: translateY(0px) rotate(0deg); }
    50% { transform: translateY(-20px) rotate(10deg); }
}

@keyframes rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

@keyframes fadeInUp {
    from { 
        opacity: 0; 
        transform: translateY(30px); 
    }
    to { 
        opacity: 1; 
        transform: translateY(0); 
    }
}

@keyframes pulse {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
}

@keyframes cardAppear {
    from { 
        opacity: 0; 
        transform: scale(0.8) translateY(-20px); 
    }
    to { 
        opacity: 1; 
        transform: scale(1) translateY(0); 
    }
}

.container {
    position: relative;
    z-index: 10;
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.header {
    text-align: center;
    margin-bottom: 30px;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

.title {
    font-size: 2.2em;
    background: linear-gradient(45deg, #f4d03f, #f7dc6f);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 10px;
    flex: 1;
    font-weight: 300;
    letter-spacing: 1px;
}

.theme-switcher {
    position: absolute;
    left: 0;
    display: flex;
    gap: 5px;
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 4px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.theme-btn {
    background: transparent;
    border: none;
    padding: 8px 12px;
    border-radius: 16px;
    cursor: pointer;
    font-size: 1.1em;
    transition: all 0.3s ease;
    color: rgba(255, 255, 255, 0.6);
}

.theme-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: scale(1.05);
}

.theme-btn.active {
    background: rgba(255, 255, 255, 0.15);
    color: #fff;
}

.help-btn {
    position: absolute;
    right: 0;
    background: rgba(244, 208, 63, 0.2);
    color: #f4d03f;
    border: 1px solid rgba(244, 208, 63, 0.3);
    padding: 8px 12px;
    border-radius: 50%;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.3s ease;
    position: relative;
}

.help-btn:hover {
    background: rgba(244, 208, 63, 0.3);
    border-color: rgba(244, 208, 63, 0.5);
}

.help-tooltip {
    position: absolute;
    bottom: 120%;
    right: 0;
    background: rgba(0, 0, 0, 0.9);
    color: #e8eaf2;
    padding: 12px 16px;
    border-radius: 12px;
    font-size: 0.85em;
    line-height: 1.4;
    width: 280px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    border: 1px solid rgba(244, 208, 63, 0.3);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.help-btn:hover .help-tooltip {
    opacity: 1;
    visibility: visible;
}

.help-tooltip::after {
    content: '';
    position: absolute;
    top: 100%;
    right: 20px;
    border: 8px solid transparent;
    border-top-color: rgba(0, 0, 0, 0.9);
}

.frame-section {
    background: rgba(255, 255, 255, 0.06);
    backdrop-filter: blur(15px);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 20px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.frame-section h3 {
    color: #f4d03f;
    margin-bottom: 16px;
    text-align: center;
    font-size: 1.1em;
    font-weight: 400;
}

.drawn-cards {
    background: rgba(0, 0, 0, 0.15);
    border-radius: 12px;
    padding: 20px;
    min-height: 120px;
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    align-items: center;
    justify-content: center;
}

.drawn-card {
    width: 50px;
    height: 65px;
    background: rgba(244, 208, 63, 0.1);
    border: 1px solid rgba(244, 208, 63, 0.3);
    border-radius: 8px;
    color: #f4d03f;
    font-size: 3.2em;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    line-height: 0.8;
    overflow: hidden;
    position: relative;
}

.drawn-card:hover {
    border-color: rgba(244, 208, 63, 0.6);
    background: rgba(244, 208, 63, 0.15);
    transform: scale(1.05) translateY(-3px);
    box-shadow: 0 8px 20px rgba(244, 208, 63, 0.2);
}

.main-layout {
    display: grid;
    grid-template-columns: 1fr;
    gap: 20px;
    margin-bottom: 20px;
}

.interpretation-area {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 20px;
    padding: 32px;
    margin-bottom: 20px;
    display: none;
    flex-direction: column;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
}

.interpretation-area.show {
    display: flex !important;
    animation: fadeInUp 0.6s ease;
}

.interpretation-content {
    text-align: left;
    color: #e8eaf2;
    line-height: 1.7;
}

.interpretation-content h4 {
    color: #fff;
    text-align: center;
    margin-bottom: 32px;
    font-size: 1.8em;
    font-weight: 300;
    font-style: italic;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.interpretation-card {
    margin: 20px 0;
    padding: 28px;
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    transition: all 0.4s ease;
    position: relative;
    overflow: hidden;
}

.interpretation-card::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    width: 4px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 2px;
}

.interpretation-card:hover {
    background: rgba(255, 255, 255, 0.08);
    transform: translateY(-2px);
    border-color: rgba(255, 255, 255, 0.2);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
}

.interpretation-card h5 {
    color: #fff;
    margin-bottom: 16px;
    font-size: 1.2em;
    font-weight: 400;
    font-style: italic;
}

.interpretation-card p {
    color: #d0d3dc;
    line-height: 1.6;
    margin: 0;
    font-size: 1.05em;
}

.loading-message {
    text-align: center;
    color: #bbb;
    font-style: italic;
    font-size: 1.1em;
    padding: 40px;
    animation: pulse 2s infinite;
}

.cards-area {
    background: rgba(255, 255, 255, 0.06);
    backdrop-filter: blur(15px);
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.cards-title {
    color: #f4d03f;
    margin-bottom: 16px;
    text-align: center;
    font-size: 1.2em;
    font-weight: 400;
}

.card-info {
    display: flex;
    gap: 20px;
    align-items: center;
    justify-content: center;
    margin-bottom: 16px;
    flex-wrap: wrap;
}

.cards-remaining {
    color: #85c1e9;
    font-weight: 500;
    background: rgba(133, 193, 233, 0.1);
    padding: 6px 12px;
    border-radius: 12px;
    display: inline-block;
    font-size: 0.9em;
    border: 1px solid rgba(133, 193, 233, 0.2);
}

.selection-status {
    color: #85c1e9;
    font-style: italic;
    font-size: 0.95em;
    background: rgba(133, 193, 233, 0.1);
    padding: 6px 12px;
    border-radius: 12px;
    border: 1px solid rgba(133, 193, 233, 0.2);
}

.deck-container-large {
    position: relative;
    width: 100%;
    height: 500px;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    margin-bottom: 16px;
    border: 1px solid rgba(244, 208, 63, 0.15);
    border-radius: 12px;
    background: rgba(0, 0, 0, 0.1);
    padding: 15px;
}

.deck-cards {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.wide-arc-card {
    position: absolute;
    width: 48px;
    height: 64px;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid #f4d03f;
    border-radius: 8px;
    font-size: 3.5em;
    color: #f4d03f;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    transform-origin: center;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    user-select: none;
    backdrop-filter: blur(10px);
    padding: 0;
    line-height: 0.8;
    overflow: hidden;
}

.wide-arc-card:hover {
    transform: scale(1.2) translateY(-8px);
    border-color: #fff;
    box-shadow: 0 12px 24px rgba(244, 208, 63, 0.3);
    z-index: 100;
    background: rgba(255, 255, 255, 0.15);
}

.deck-actions {
    display: flex;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
}

.deck-btn, .action-btn {
    background: rgba(244, 208, 63, 0.2);
    border: 1px solid rgba(244, 208, 63, 0.4);
    color: #f4d03f;
    padding: 12px 20px;
    border-radius: 12px;
    cursor: pointer;
    font-family: 'Georgia', 'Times New Roman', serif;
    font-style: italic;
    font-weight: 400;
    transition: all 0.3s ease;
    font-size: 0.9em;
    backdrop-filter: blur(10px);
}

.deck-btn:hover, .action-btn:hover {
    background: rgba(244, 208, 63, 0.3);
    border-color: rgba(244, 208, 63, 0.6);
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(244, 208, 63, 0.2);
}

.action-btn:disabled {
    background: rgba(255, 255, 255, 0.03);
    border-color: rgba(255, 255, 255, 0.05);
    color: rgba(255, 255, 255, 0.3);
    cursor: not-allowed;
    opacity: 0.5;
}

.status {
    text-align: center;
    padding: 16px;
    background: rgba(255, 255, 255, 0.06);
    border-radius: 12px;
    margin: 20px 0;
    font-style: italic;
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #d5d8e0;
}

@media (max-width: 768px) {
    .header {
        flex-direction: column;
        gap: 15px;
    }
    
    .theme-switcher {
        position: static;
    }
    
    .help-btn {
        position: static;
    }
    
    .frame-section {
        padding: 20px;
    }
    
    .deck-actions {
        flex-direction: column;
        align-items: center;
        gap: 10px;
    }
    
    .card-info {
        flex-direction: column;
        gap: 10px;
    }
    
    .title {
        font-size: 1.8em;
    }

    .help-tooltip {
        width: 240px;
        right: -100px;
    }
}
</style>
</head>
<body>
<div class="stars" id="stars"></div>
<div class="container">
    <header class="header">
        <h1 class="title">⋅˚₊‧ ୨୧ Mystical Tarot ୨୧ ‧₊˚⋅</h1>
        <div class="theme-switcher">
            <button class="theme-btn active" data-theme="default" onclick="switchTheme('default')">🌙</button>
            <button class="theme-btn" data-theme="love" onclick="switchTheme('love')">💖</button>
            <button class="theme-btn" data-theme="career" onclick="switchTheme('career')">⭐</button>
        </div>
        <button class="help-btn">
            ?
            <div class="help-tooltip">
                Click cards from deck to select them → use "Read Cards" for interpretation → themes change colors and card meanings for love/career guidance.
            </div>
        </button>
    </header>

    <!-- Selected Cards Display Frame -->
    <div class="frame-section">
        <h3>🔮 Selected Cards</h3>
        <div class="drawn-cards" id="drawnCards">
            <p style="color: #a8a8a8; font-style: italic;">Select cards from deck...</p>
        </div>
    </div>

    <!-- Yorum area'sı selected frame'in altında -->
    <div class="interpretation-area" id="interpretationArea">
        <div class="interpretation-content" id="interpretationContent"></div>
    </div>

    <div class="main-layout">
        <div class="cards-area">
            <h3 class="cards-title">Cards</h3>
            <div class="card-info" id="cardInfo">
                <span class="cards-remaining">Cards: <span id="cardsLeft">78</span></span>
                <span class="selection-status" id="selectionStatus"></span>
            </div>
            <div class="deck-container-large">
                <div class="deck-cards" id="deckCards"></div>
            </div>
            <div class="deck-actions">
                <button class="deck-btn" onclick="shuffleDeck()">Shuffle Deck</button>
                <button class="action-btn" id="readCardsBtn" onclick="interpretSelected()" disabled>Read Cards</button>
                <button class="action-btn" onclick="randomReading()">Random Reading</button>
                <button class="action-btn" onclick="returnCards()" style="display: none;" id="returnBtn">Return All Cards</button>
            </div>
        </div>
    </div>

    <div class="status" id="status">
        Welcome to Mystical Tarot! Choose a reading type to begin.
    </div>
</div>

<script>
// Tarot deck data
const tarotDeck = [
    // Major Arcana
    { name: "The Fool", group: "major", number: 0 },
    { name: "The Magician", group: "major", number: 1 },
    { name: "The High Priestess", group: "major", number: 2 },
    { name: "The Empress", group: "major", number: 3 },
    { name: "The Emperor", group: "major", number: 4 },
    { name: "The Hierophant", group: "major", number: 5 },
    { name: "The Lovers", group: "major", number: 6 },
    { name: "The Chariot", group: "major", number: 7 },
    { name: "Strength", group: "major", number: 8 },
    { name: "The Hermit", group: "major", number: 9 },
    { name: "Wheel of Fortune", group: "major", number: 10 },
    { name: "Justice", group: "major", number: 11 },
    { name: "The Hanged Man", group: "major", number: 12 },
    { name: "Death", group: "major", number: 13 },
    { name: "Temperance", group: "major", number: 14 },
    { name: "The Devil", group: "major", number: 15 },
    { name: "The Tower", group: "major", number: 16 },
    { name: "The Star", group: "major", number: 17 },
    { name: "The Moon", group: "major", number: 18 },
    { name: "The Sun", group: "major", number: 19 },
    { name: "Judgement", group: "major", number: 20 },
    { name: "The World", group: "major", number: 21 }
];

// Add Minor Arcana
const suits = ['cups', 'wands', 'swords', 'pentacles'];
const numbers = ['Ace', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'Page', 'Knight', 'Queen', 'King'];

suits.forEach(suit => {
    numbers.forEach((num, index) => {
        tarotDeck.push({
            name: `${num} of ${suit.charAt(0).toUpperCase() + suit.slice(1)}`,
            group: suit,
            number: index + 1
        });
    });
});

// Game state
let currentDeck = [...tarotDeck];
let selectedCards = [];
let currentReading = [];
let selectedTopic = 'general';

// Initialize the game
function initGame() {
    shuffleDeck();
    updateDisplay();
    createStars();
}

function createStars() {
    const starsContainer = document.getElementById('stars');
    starsContainer.innerHTML = '';
    for (let i = 0; i < 50; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.width = Math.random() * 3 + 1 + 'px';
        star.style.height = star.style.width;
        star.style.animationDelay = Math.random() * 3 + 's';
        starsContainer.appendChild(star);
    }
}

function shuffleDeck() {
    // Desteki sıfırla ve karıştır
    currentDeck = [...tarotDeck];
    for (let i = currentDeck.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [currentDeck[i], currentDeck[j]] = [currentDeck[j], currentDeck[i]];
    }
    
    // Seçimleri temizle
    selectedCards = [];
    currentReading = [];
    
    // Yorum alanını gizle
    document.getElementById('interpretationArea').classList.remove('show');
    
    updateDisplay();
    updateStatus("Deck shuffled! ✨ Ready for your mystical reading.");
}

function switchTheme(theme) {
    const body = document.body;
    const buttons = document.querySelectorAll('.theme-btn');
    
    buttons.forEach(btn => btn.classList.remove('active'));
    document.querySelector(`[data-theme="${theme}"]`).classList.add('active');
    
    body.classList.remove('love-theme', 'career-theme');
    
    if (theme === 'love') {
        body.classList.add('love-theme');
        selectedTopic = 'love';
        createLoveParticles();
        updateStatus("Love theme activated! 💖 Click cards to explore matters of the heart ✨");
    } else if (theme === 'career') {
        body.classList.add('career-theme');
        selectedTopic = 'career';
        createStarParticles();
        updateStatus("Career theme activated! ⭐ Click cards to discover your professional path ✨");
    } else {
        selectedTopic = 'general';
        createStars();
        updateStatus("Default mystical theme activated! 🌙 Click cards for general life guidance ✨");
    }
}

function createLoveParticles() {
    const starsContainer = document.getElementById('stars');
    starsContainer.innerHTML = '';
    
    for (let i = 0; i < 30; i++) {
        const heart = document.createElement('div');
        heart.innerHTML = '💖';
        heart.style.position = 'absolute';
        heart.style.left = Math.random() * 100 + '%';
        heart.style.top = Math.random() * 100 + '%';
        heart.style.fontSize = Math.random() * 20 + 10 + 'px';
        heart.style.animationDelay = Math.random() * 3 + 's';
        heart.style.animation = 'twinkle 3s infinite, float 6s infinite ease-in-out';
        heart.style.pointerEvents = 'none';
        starsContainer.appendChild(heart);
    }
}

function createStarParticles() {
    const starsContainer = document.getElementById('stars');
    starsContainer.innerHTML = '';
    
    for (let i = 0; i < 40; i++) {
        const star = document.createElement('div');
        star.innerHTML = '⭐';
        star.style.position = 'absolute';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.fontSize = Math.random() * 15 + 8 + 'px';
        star.style.animationDelay = Math.random() * 3 + 's';
        star.style.animation = 'twinkle 3s infinite, rotate 8s infinite linear';
        star.style.pointerEvents = 'none';
        starsContainer.appendChild(star);
    }
}

function selectCardFromDeck(cardIndex) {
    if (cardIndex >= currentDeck.length) return;
    
    if (selectedCards.length >= 5) {
        updateStatus("Maximum 5 cards can be selected! ⚠️");
        return;
    }
    
    // Kartı desteden çıkar ve seçilenlere ekle
    const selectedCard = currentDeck.splice(cardIndex, 1)[0];
    selectedCards.push(selectedCard);
    
    updateDisplay();
    updateStatus(`Card selected: ${selectedCard.name}! (${selectedCards.length}/5 cards selected)`);
}

function interpretSelected() {
    if (selectedCards.length === 0) {
        updateStatus("Please select at least one card first! 🎯");
        return;
    }
    
    // Seçilen kartları reading'e aktar
    currentReading = [...selectedCards];
    
    // Loading mesajı göster
    showInterpretationLoading();
    
    // 2 saniye sonra yorumları göster
    setTimeout(() => {
        showInterpretationArea();
    }, 2000);
}

function showInterpretationLoading() {
    const interpretationArea = document.getElementById('interpretationArea');
    const contentDiv = document.getElementById('interpretationContent');
    
    // Loading mesajı
    contentDiv.innerHTML = '<div class="loading-message">🔮 Mystical energies are being consulted...</div>';
    
    // Yorum alanını göster
    interpretationArea.classList.add('show');
    
    // Scroll to interpretation area
    setTimeout(() => {
        interpretationArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, 100);
}

function randomReading() {
    // Random tema seç
    const themes = ['default', 'love', 'career'];
    const randomTheme = themes[Math.floor(Math.random() * themes.length)];
    switchTheme(randomTheme);

    const maxCards = Math.min(3, currentDeck.length);
    if (maxCards === 0) {
        updateStatus("No cards left in deck! Please shuffle or return cards.");
        return;
    }

    // Random sayıda kart seç
    const spreadSize = Math.floor(Math.random() * maxCards) + 1;
    selectedCards = [];
    
    for (let i = 0; i < spreadSize; i++) {
        const randomIndex = Math.floor(Math.random() * currentDeck.length);
        const card = currentDeck.splice(randomIndex, 1)[0];
        selectedCards.push(card);
    }
    
    currentReading = [...selectedCards];
    updateDisplay();
    
    // Loading ve sonra yorum göster
    showInterpretationLoading();
    setTimeout(() => {
        showInterpretationArea();
    }, 2000);
    
    const topicDisplay = selectedTopic === 'general' ? 'general life guidance' : selectedTopic;
    updateStatus(`Random reading: ${spreadSize} cards for ${topicDisplay}! 🎲✨`);
}

function showInterpretationArea() {
    const interpretationArea = document.getElementById('interpretationArea');
    const contentDiv = document.getElementById('interpretationContent');
    
    // Yorumları yeniden oluştur
    const topicDisplay = selectedTopic === 'general' ? 'General Life Guidance' : 
                       selectedTopic.charAt(0).toUpperCase() + selectedTopic.slice(1);
    
    // Her kart için yeniden meaning al ve ekle
    setTimeout(async () => {
        let fullInterpretation = `<h4>Your ${topicDisplay} Reading</h4>`;
        
        for (let i = 0; i < currentReading.length; i++) {
            const card = currentReading[i];
            const meaning = await getCardMeaning(card, selectedTopic);
            
            fullInterpretation += `<div class="interpretation-card">
                <h5>Card ${i + 1}: ${card.name}</h5>
                <p>${meaning}</p>
            </div>`;
        }
        
        contentDiv.innerHTML = fullInterpretation;
    }, 100);
    
    // Yorum alanını göster
    interpretationArea.classList.add('show');
}

async function getCardMeaning(card, topic) {
    const generalMeanings = {
        "The Fool": "New beginnings, spontaneity, and taking a leap of faith. Trust your instincts and embrace the unknown.",
        "The Magician": "Manifestation, resourcefulness, and personal power. You have all the tools needed to succeed.",
        "The High Priestess": "Intuition, sacred knowledge, and inner wisdom. Listen to your subconscious mind.",
        "The Empress": "Fertility, femininity, and abundance. Creativity and nurturing energy surround you.",
        "The Emperor": "Authority, structure, and control. Take charge of your situation with confidence.",
        "The Hierophant": "Tradition, spiritual guidance, and conformity. Seek wisdom from established sources.",
        "The Lovers": "Love, harmony, and choices. An important decision regarding relationships awaits.",
        "The Chariot": "Victory, determination, and control. Move forward with confidence and willpower.",
        "Strength": "Inner strength, courage, and patience. You have the power to overcome any challenge.",
        "The Hermit": "Soul searching, introspection, and guidance. Look within for the answers you seek.",
        "Wheel of Fortune": "Good fortune, karma, and life cycles. Change and opportunity are coming.",
        "Justice": "Justice, fairness, and truth. Balance and accountability are needed in this situation.",
        "The Hanged Man": "Suspension, restriction, and letting go. Sometimes patience and surrender are required.",
        "Death": "Transformation, endings, and new beginnings. A major life change is occurring.",
        "Temperance": "Balance, moderation, and patience. Find harmony and the middle path.",
        "The Devil": "Bondage, materialism, and temptation. Examine what may be holding you back.",
        "The Tower": "Sudden upheaval, broken pride, and disaster. Expect unexpected changes.",
        "The Star": "Hope, spirituality, and renewal. Your wishes and dreams may come true.",
        "The Moon": "Illusion, fear, and anxiety. Not everything is as it seems - trust your intuition.",
        "The Sun": "Joy, success, and vitality. Happiness, achievement, and positive energy await.",
        "Judgement": "Judgement, rebirth, and inner calling. A second chance and spiritual awakening.",
        "The World": "Completion, accomplishment, and travel. Success, fulfillment, and achievement of goals."
    };

    let baseMeaning = generalMeanings[card.name];
    
    if (!baseMeaning) {
        // Minor arcana meanings
        if (card.name.includes('Ace')) {
            baseMeaning = "New beginnings and pure potential in this area of life.";
        } else if (card.name.includes('2')) {
            baseMeaning = "Balance, partnerships, and choices that need to be made.";
        } else if (card.name.includes('3')) {
            baseMeaning = "Growth, creativity, and initial success in your endeavors.";
        } else if (card.name.includes('4')) {
            baseMeaning = "Stability, foundation, and the need for solid structure.";
        } else if (card.name.includes('5')) {
            baseMeaning = "Conflict, change, and challenges that lead to growth.";
        } else if (card.name.includes('6')) {
            baseMeaning = "Harmony, healing, and moving toward better times.";
        } else if (card.name.includes('7')) {
            baseMeaning = "Reflection, assessment, and spiritual development.";
        } else if (card.name.includes('8')) {
            baseMeaning = "Movement, progress, and mastery of skills.";
        } else if (card.name.includes('9')) {
            baseMeaning = "Near completion, wisdom gained, and approaching fulfillment.";
        } else if (card.name.includes('10')) {
            baseMeaning = "Completion of a cycle, culmination, and new beginnings ahead.";
        } else if (card.name.includes('Page')) {
            baseMeaning = "New learning, messages, and youthful energy in this area.";
        } else if (card.name.includes('Knight')) {
            baseMeaning = "Action, adventure, and dynamic movement toward goals.";
        } else if (card.name.includes('Queen')) {
            baseMeaning = "Mastery, intuition, and nurturing wisdom in this realm.";
        } else if (card.name.includes('King')) {
            baseMeaning = "Authority, mastery, and leadership in this domain.";
        }
        
        // Suit meanings
        if (card.group === 'cups') {
            baseMeaning += " This relates to emotions, relationships, love, and spiritual connections.";
        } else if (card.group === 'wands') {
            baseMeaning += " This concerns career, creativity, passion, and personal growth.";
        } else if (card.group === 'swords') {
            baseMeaning += " This involves thoughts, communication, conflict, and mental challenges.";
        } else if (card.group === 'pentacles') {
            baseMeaning += " This focuses on material matters, money, health, and practical concerns.";
        }
    }

    // Topic-specific modifications
    let contextualMeaning = baseMeaning;
    if (topic === 'love') {
        contextualMeaning += " In matters of the heart, this suggests deep emotional growth and meaningful connections in your romantic life.";
    } else if (topic === 'career') {
        contextualMeaning += " In your professional life, this indicates opportunities for advancement, success, and career development.";
    } else {
        contextualMeaning += " This card brings general guidance for your life path and personal development journey.";
    }

    return contextualMeaning;
}

function returnCards() {
    // Tüm seçilen kartları destede geri koy
    currentDeck.push(...selectedCards);
    selectedCards = [];
    currentReading = [];
    
    // Yorum alanını gizle
    document.getElementById('interpretationArea').classList.remove('show');
    
    shuffleDeck();
    updateStatus("All cards returned to deck and shuffled! ✨");
}

function updateDisplay() {
    updateDeckDisplay();
    updateDrawnDisplay();
    updateCounters();
    updateReadButton();
}

function updateDeckDisplay() {
    const deckDiv = document.getElementById('deckCards');
    deckDiv.innerHTML = '';
    
    const totalCards = currentDeck.length;
    const containerWidth = deckDiv.parentElement.clientWidth - 30;
    const containerHeight = 500;
    
    // FIXED POSITIONS - Kartlar seçilince karışmaz, sadece o kart kaybolur
    const fixedPositions = [];
    for (let i = 0; i < 78; i++) {
        const cols = Math.ceil(Math.sqrt(78 * 1.2));
        const col = i % cols;
        const row = Math.floor(i / cols);
        
        const cardSpacing = Math.min(50, (containerWidth - 100) / cols);
        const rowSpacing = Math.min(65, (containerHeight - 100) / Math.ceil(78 / cols));
        
        const x = col * cardSpacing + 50 + (Math.sin(i) * 15);
        const y = row * rowSpacing + 50 + (Math.cos(i) * 15);
        
        fixedPositions.push({
            x: Math.max(10, Math.min(x, containerWidth - 58)),
            y: Math.max(10, Math.min(y, containerHeight - 74)),
            rotation: (Math.sin(i * 0.5) * 25)
        });
    }
    
    currentDeck.forEach((card, index) => {
        const cardDiv = document.createElement('div');
        cardDiv.className = 'wide-arc-card';
        
        // Orijinal kartın pozisyonunu bul
        const originalIndex = tarotDeck.findIndex(c => c.name === card.name);
        const pos = fixedPositions[originalIndex] || fixedPositions[index];
        
        cardDiv.style.left = `${pos.x}px`;
        cardDiv.style.top = `${pos.y}px`;
        cardDiv.style.transform = `rotate(${pos.rotation}deg)`;
        
        cardDiv.onclick = () => selectCardFromDeck(index);
        
        // TÜM KARTLAR 🃏 EMOJİ
        cardDiv.textContent = '🃏';
        cardDiv.title = `${card.name} - Click to select`;
        deckDiv.appendChild(cardDiv);
    });
}

function updateDrawnDisplay() {
    const drawnDiv = document.getElementById('drawnCards');
    const returnBtn = document.getElementById('returnBtn');
    
    if (selectedCards.length > 0) {
        returnBtn.style.display = 'inline-block';
    } else {
        returnBtn.style.display = 'none';
    }
    
    if (selectedCards.length === 0) {
        drawnDiv.innerHTML = '<p style="color: #a8a8a8; font-style: italic; text-align: center; width: 100%; margin: 0;">Select cards from deck...</p>';
    } else {
        drawnDiv.innerHTML = '';
        drawnDiv.style.justifyContent = 'flex-start';
        selectedCards.forEach((card, index) => {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'drawn-card';
            
            // TÜM KARTLAR 🃏 EMOJİ
            cardDiv.textContent = '🃏';
            cardDiv.title = `${card.name} - Selected`;
            
            // Kart sırasına göre animasyon
            cardDiv.style.animationDelay = `${index * 0.1}s`;
            cardDiv.style.animation = 'cardAppear 0.4s ease forwards';
            
            drawnDiv.appendChild(cardDiv);
        });
    }
    
    // Selection status update
    updateSelectionStatus();
}

function updateSelectionStatus() {
    const statusSpan = document.getElementById('selectionStatus');
    if (selectedCards.length > 0) {
        const lastCard = selectedCards[selectedCards.length - 1];
        statusSpan.textContent = `Card selected: ${lastCard.name}! (${selectedCards.length}/5 cards selected)`;
    } else {
        statusSpan.textContent = '';
    }
}

function updateCounters() {
    document.getElementById('cardsLeft').textContent = currentDeck.length;
}

function updateReadButton() {
    const readBtn = document.getElementById('readCardsBtn');
    if (selectedCards.length > 0) {
        readBtn.disabled = false;
        readBtn.style.opacity = '1';
    } else {
        readBtn.disabled = true;
        readBtn.style.opacity = '0.5';
    }
}

function updateStatus(message) {
    document.getElementById('status').textContent = message;
}

// Initialize
document.addEventListener('DOMContentLoaded', function() {
    initGame();
});
</script>
</body>
</html>